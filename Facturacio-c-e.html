<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario facturación</title>
</head>
<body>
<div id="titol">
    <h1 align="center">Facturación</h1>
    
</div>
<div id="TipoCliente">
<h1>Tipo de cliente</h1>

<div id="tipousuario">
    <input type="radio" id="personafisica" name="drone" value="Persona Física" checked onfocus="cambiaraClient()" />
    <label for="personafisica">Persona Física</label>
  </div>

  <div>
    <input type="radio" id="empresa" name="drone" value="Empresa" onfocus="cambiaraEmpresa()" />
    <label for="empresa">Empresa</label>
  </div>
</div>
<div id="formulariocliente">
    <h1>Datos del cliente</h1>
    <div id="Cliente">
        <form>
            <p>Nombre:</p>
            <input id="nombre" title="Nombre" placeholder="Nombre Completo" required  pattern="[A-Za-z]{1,30}">


            <br><br><br>
            <select class="form-control form-select form-select-lg mb-3"  aria-label="Default select example" id="tipoDoc" >
                <option selected>Tipo Documento</option>
                <option value="1">DNI</option>
                <option value="2">NIA</option>
                <option value="3">PASSPORT</option>
              </select>
              <br>
              <label class="form-label" for="documento">Documento</label>
          <input type="text" id="documento" class="form-control" />
<br><br>

            <p>Telefono:</p>
            <input id="telefono" title="Telefono" placeholder="Telefono" required  pattern="[0-9]{9}">
            <p>Email:</p>
            <input id="email" title="Email" placeholder="Email" required type="email">
        <div id="direccion">  
        <p>Dirección</p>
     <input id="direccion" title="Dirección" placeholder="Dirección" style="width:300px;" required >
            <p>Seleccione metodo de pago</p>
            <select name="Metodo de pago" id="opcionpago">
                <option value="mastercard">MasterCard</option>
                <option value="paypal">Paypal</option>
                <option value="visa">Visa</option>
            </select>
            <br><br>
            <input type="checkbox" id="terminos" value="Acepto Terminos y condiciones" required >
            <label>Acepto Terminos y Condiciones</label>
            <br>
            <button id="pagar" type="submit" >Pagar</button>
        </div> 
    </div>
        </form>
</div>


<script>
      window.onload=main;
    function main(){
 
    document.getElementById("pagar").addEventListener("click",validarClient);
    
    document.getElementById("tipoDoc").addEventListener("change",valorRadio);
    
}






    function cambiaraClient(){
       
        var formulario=document.getElementById("formulariocliente");
        formulario.innerHTML="<div id="+"formulariocliente+"+">"+
    "<h1>Datos del cliente</h1>"+
    "<div id="+"Cliente"+">"+
        "<form>"
            +"<p>Nombre Completo:</p>"+
            "<input id="+"nombre"+" title="+"Nombre"+" placeholder=\"Nombre Completo\"+pattern="+"[A-Za-z]+"+"   >"+

            "<br><br><br>"+
            "<select class="+"form-control form-select form-select-lg mb-3"+"  aria-label="+"Default select example"+" id="+"tipoDoc"+" >"+
                "<option selected>Tipo Documento</option>"+
                "<option value=\"1\">DNI</option>"+
                "<option value=\"2\">NIA</option>"+
                "<option value=\"3\">PASSPORT</option>"+
              "</select>"+
              "<br>"+
              "<label class=\"form-label\" for=\"documento\">Documento</label>"+
          "<input type=\"text\" id=\"documento\" class=\"form-control\" />"+
"<br><br>"+

            "<p>Telefono:</p>"+
            "<input id="+"telefono"+" title="+"Telefono"+" placeholder="+"Telefono"+"  "+"pattern="+"[0-9]{9}"+" >"+
            "<p>Email:</p>"+
            "<input id=\"email\" title=\"Email\" type=\"email\" placeholder=\"Email\" required>"+
        "<div id="+"direccion"+">"+  
        "<p>Dirección</p>"+
     "<input id="+"direccion"+" title="+"Dirección"+" placeholder="+"Dirección"+" style="+"width:300px;"+">"+
            "<p>Seleccione metodo de pago</p>"+
            "<select name="+"Metodo de pago"+" id="+"opcionpago"+">"+
                "<option value="+"mastercard"+">MasterCard</option>"+
                "<option value="+"paypal"+">Paypal</option>"+
                "<option value="+"visa"+">Visa</option>"+
            "</select>"+
            "<br><br>"+
            "<input type="+"checkbox"+" id=\"terminos\" required"+" value="+"Acepto Terminos y condiciones"+">"+
            "<label>Acepto Terminos y Condiciones</label>"+
            "<br>"+
            "<button id="+"pagar"+" >Pagar</button>"+
        "</div>"+ 
    "</div>"+
        "</form>"+
"</div>";

document.getElementById("pagar").addEventListener("click",validarClient);
    }

    function cambiaraEmpresa(){
        var formulario=document.getElementById("formulariocliente");
        formulario.innerHTML="<div id="+"formularioempresa+"+">"+
    "<h1>Datos de la empresa</h1>"+
    "<div id="+"Empresa"+">"+
        "<form>"+
            "<p>Nombre de la Empresa:</p>"+
            "<input id="+"nombre"+" title="+"Nombre"+" placeholder="+"Nombre"+"  "+"pattern=\"/^[a-zA-Z0-9!@#$%^&*]+$/\"required >"+
            "<p>CIF de la Empresa:</p>"+
            "<input id="+"cif"+" title="+"Cif"+" placeholder="+"Introduce el CIF"+"  "+"pattern=\"^[a-zA-Z][0-9]{8}$\"required >"+
            "<p>Dominio:   (opcional)</p>"+
            "<input id="+"dominio"+" title="+"Dominio"+" placeholder="+"Dominio"+" >"+
            "<p>Telefono:</p>"+
            "<input id="+"telefono"+" title="+"Telefono"+" placeholder="+"Telefono"+" "+"pattern=\"[0-9]{9}+\"required >"+
            "<p>Email:</p>"+
            "<input id="+"email"+" title=\"Email\"type=\"email\" placeholder=\"Email\" required >"+
        "<div id="+"direccion"+">"+  
        "<p>Dirección</p>"+
     "<input id="+"direccion"+" title="+"Dirección"+" placeholder="+"Dirección"+" style="+"width:300px;"+"required >"+
            "<p>Seleccione metodo de pago</p>"+
            "<select name="+"Metodo de pago"+" id=\"opcionpago\"required >"+
                "<option value="+"mastercard"+">MasterCard</option>"+
                "<option value="+"paypal"+">Paypal</option>"+
                "<option value="+"visa"+">Visa</option>"+
            "</select>"+
            "<br><br>"+
            "<input type="+"checkbox"+" id=\"terminos\" required >"+
            "<label>Acepto Terminos y Condiciones</label>"+
            "<br>"+
            "<button id=\"pagar\"  >Pagar</button>"+
        "</div>"+ 
    "</div>"+
        "</form>"+
"</div>";
document.getElementById("pagar").addEventListener("click",validarEmpresari);
    }
    function validarNom () {
           var element = document.getElementById("nombre");
           if (!element.checkValidity()){
               if (element.validity.valueMissing){
                   alert("Deus d'introduïr un nom correcte.");
               }
               if (element.validity.patternMismatch){
                   alert("El nom sols pot contindre caracters.");
               }
               //error(element);
               return false;
           }
           return true;}
          
     function validarCIF () {
           var element = document.getElementById("cif");
           if (!element.checkValidity()){
               if (element.validity.valueMissing){
                   alert("Deus d'introduïr un CIF correcte.");
               }
               if (element.validity.patternMismatch){
                   alert("El CIF es incorrecte.");
               }
               //error(element);
               return false;
           }
           return true;}

           function validarEmail () {
           var element = document.getElementById("email");
           if (!element.checkValidity()){
               if (element.validity.valueMissing){
                   alert("Deus d'introduïr un email correcte.");
               }
               if (element.validity.patternMismatch){
                   alert("El email es incorrecte.");
               }
               //error(element);
               return false;
           }
           return true;}

        function validarPrivacitat () {
           var element = document.getElementById("terminos");
           if (!element.checked){
              alert("Debes de aceptar las condiciones de privacidad");
               return false;
           }
           console.log("Condiciones aceptadas");
           return true;}

    function validarClient(e) {
    e.preventDefault();
    elementDoc=document.getElementById("documento");
    if ( valorRadio()&&validarNom() && validarPrivacitat()&& confirm("Confirma si vols enviar el formulari") ){
        redireccionar();
        return true;

    }else{
        console.log("El DNI es incorrecto")
        return false;
    }
}

function validarEmpresari(e) {
    e.preventDefault();
    if (validarPrivacitat () && validarCIF()&& confirm("Confirma si vols enviar el formulari") ){
        redireccionar();
        return true;

    }else{
        console.log("El DNI es incorrecto")
        return false;
    }
}

    function redireccionar(){
        var selectpago = document.getElementById("opcionpago");
      var opcionSeleccionada = selectpago.options[selectpago.selectedIndex].value;
        alert(opcionSeleccionada);
      switch(opcionSeleccionada){
        case "mastercard":
        window.location.href = "mastercard.html";
        alert(window.location.href);
        break;

        case "paypal":
        window.location.href = "www.paypal.com";
        break;

        case "visa":
        window.location.href = "visa.html";
        break;
      }
    }


    //Validacions
    function averigua(dni) {
  var numero;
  var letr;
  var letra;
 
     numero = dni.substr(0,dni.length-1);
     letr = dni.substr(dni.length-1,1);
     numero = numero % 23;
     letra='TRWAGMYFPDXBNJZSQVHLCKET';
     letra=letra.substring(numero,numero+1);
     alert(letra);
    if (letra!=letr.toUpperCase()) {
       console.log('Dni erroneo, la letra del NIF no se corresponde');
       return false;
     }else{
       console.log('Dni correcto');
       return true;
     }
  }
  function valorRadio(){
    selector = document.getElementById("tipoDoc").value;
    campoDoc = document.getElementById("documento").value;
    console.log(selector);
    console.log(typeof(selector));
    switch (selector) {
        case "1":
            if(averigua(campoDoc)){
            if(campoDoc.match(/[0-9]{7,8}[A-Z]/)){
                return true;
            }
            else {
                return false;
            }
        }
        case "2":
            if(campoDoc.match(/^([0-9]{8}[A-Z])|[XYZ][0-9]{7}[A-Z]$/)){
                return true;
            }
            else {
                return false;
            }
        case "3":
            if(campoDoc.match(/^[a-zA-Z]{3}[0-9]{6}[a-zA-Z]?$/)){
                return true;
            }
            else {
                return false;
            }
    
        default:
            break;
    }

    

}
</script>
</body>
</html>


